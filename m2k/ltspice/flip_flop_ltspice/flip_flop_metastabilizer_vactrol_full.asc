Version 4
SHEET 1 2716 680
WIRE -192 -1040 -256 -1040
WIRE -128 -1040 -192 -1040
WIRE 160 -1040 -128 -1040
WIRE -128 -1024 -128 -1040
WIRE -256 -992 -256 -1040
WIRE 160 -944 160 -1040
WIRE -128 -928 -128 -944
WIRE -32 -928 -128 -928
WIRE -128 -912 -128 -928
WIRE -256 -816 -256 -912
WIRE -128 -816 -128 -832
WIRE -128 -816 -256 -816
WIRE 160 -816 160 -864
WIRE -256 -800 -256 -816
WIRE 880 -464 816 -464
WIRE 816 -448 816 -464
WIRE 1840 -448 1840 -464
WIRE 880 -416 880 -464
WIRE 1840 -384 1840 -448
WIRE 224 -368 160 -368
WIRE 352 -368 304 -368
WIRE 448 -368 416 -368
WIRE 560 -368 448 -368
WIRE 640 -368 560 -368
WIRE 560 -352 560 -368
WIRE 1600 -336 1552 -336
WIRE 1744 -336 1664 -336
WIRE 720 -304 704 -304
WIRE 816 -304 816 -368
WIRE 816 -304 784 -304
WIRE 848 -304 816 -304
WIRE 848 -288 832 -288
WIRE 944 -288 912 -288
WIRE 832 -272 832 -288
WIRE 848 -272 832 -272
WIRE 1120 -272 1120 -304
WIRE 1840 -272 1840 -304
WIRE 448 -256 448 -368
WIRE 560 -256 560 -288
WIRE 832 -256 832 -272
WIRE 848 -256 832 -256
WIRE 640 -240 640 -368
WIRE 848 -240 640 -240
WIRE 832 -224 832 -256
WIRE 864 -224 864 -240
WIRE 864 -224 832 -224
WIRE 944 -224 944 -288
WIRE 1008 -224 944 -224
WIRE 1040 -224 1008 -224
WIRE 1248 -224 1200 -224
WIRE -160 -208 -192 -208
WIRE -112 -208 -160 -208
WIRE -64 -208 -112 -208
WIRE 48 -208 0 -208
WIRE 160 -208 160 -368
WIRE 160 -208 48 -208
WIRE 384 -208 160 -208
WIRE 864 -208 864 -224
WIRE 992 -176 944 -176
WIRE 1040 -176 992 -176
WIRE 1248 -176 1216 -176
WIRE 1296 -176 1248 -176
WIRE 1392 -176 1376 -176
WIRE 1424 -176 1392 -176
WIRE 1552 -176 1552 -336
WIRE 1552 -176 1504 -176
WIRE 1616 -176 1552 -176
WIRE 48 -160 48 -208
WIRE 1744 -160 1744 -336
WIRE 1744 -160 1680 -160
WIRE 1792 -160 1744 -160
WIRE 1840 -160 1840 -208
WIRE 1840 -160 1792 -160
WIRE -192 -144 -192 -208
WIRE 848 -144 640 -144
WIRE 1392 -144 1392 -176
WIRE 1616 -144 1584 -144
WIRE 848 -128 832 -128
WIRE 944 -128 944 -176
WIRE 944 -128 912 -128
WIRE 1040 -128 1024 -128
WIRE 832 -112 832 -128
WIRE 848 -112 832 -112
WIRE 1840 -112 1840 -160
WIRE 832 -96 832 -112
WIRE 848 -96 832 -96
WIRE 1024 -96 1024 -128
WIRE 1120 -96 1120 -128
WIRE 720 -80 704 -80
WIRE 816 -80 784 -80
WIRE 848 -80 816 -80
WIRE 160 -64 160 -208
WIRE 208 -64 160 -64
WIRE 336 -64 288 -64
WIRE 448 -64 448 -144
WIRE 448 -64 400 -64
WIRE 560 -64 448 -64
WIRE 640 -64 640 -144
WIRE 640 -64 560 -64
WIRE 832 -64 832 -96
WIRE 864 -64 864 -80
WIRE 864 -64 832 -64
WIRE 1584 -64 1584 -144
WIRE 1632 -64 1584 -64
WIRE 48 -48 48 -80
WIRE 560 -48 560 -64
WIRE 864 -48 864 -64
WIRE 1392 -48 1392 -80
WIRE 816 -32 816 -80
WIRE 1536 -16 1536 -48
WIRE -192 0 -192 -64
WIRE 1840 0 1840 -48
WIRE 1632 32 1632 -64
WIRE 1632 32 1600 32
WIRE 560 48 560 16
WIRE 816 80 816 48
WIRE -112 128 -112 -208
WIRE 704 128 704 -80
WIRE 704 128 -112 128
WIRE 1536 128 1536 96
WIRE 1840 128 1840 80
FLAG 1024 -96 0
FLAG 1120 -304 0
FLAG -192 0 0
FLAG -160 -208 CLKIN
FLAG 992 -176 CLK
FLAG 1008 -224 D
FLAG 1248 -224 Q
FLAG 1120 -96 0
FLAG -256 -800 0
FLAG -192 -1040 Vcc
FLAG 1648 -192 Vcc
FLAG 1648 -128 0
FLAG -32 -928 vcc_div_2
FLAG 1792 -160 Vtrim
FLAG 160 -816 0
FLAG 560 -256 0
FLAG 1840 -448 Vcc
FLAG 1840 128 0
FLAG 864 -208 0
FLAG 864 -48 0
FLAG 560 48 0
FLAG 48 -48 0
FLAG 816 80 0
FLAG 880 -416 0
FLAG 1536 -48 Vcc
FLAG 1536 128 0
FLAG 1248 -176 Qbar
FLAG 704 -304 Qbar
FLAG 1392 -48 0
SYMBOL voltage -192 -160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -105 -105 Left 2
SYMATTR Value PULSE(0 5 0 5n 5n 50u 100u)
SYMATTR InstName V1
SYMBOL voltage -256 -1008 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 3.3
SYMBOL res 1520 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL cap 1664 -352 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL res -144 -1040 R0
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL res -144 -928 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL res 144 -960 R0
SYMATTR InstName R5
SYMATTR Value R={0.1/I(D1)}
SYMBOL cap 544 -352 R0
SYMATTR InstName C3
SYMATTR Value 30p
SYMBOL diode 1824 -112 R0
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL diode 1824 -272 R0
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL res 1824 -16 R0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL res 1824 -400 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL potentiometer 432 -240 R0
WINDOW 39 53 5 VRight 0
SYMATTR SpiceLine R=5k, Val=50
SYMATTR InstName X1
SYMBOL res 208 -352 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 94 81 VBottom 2
SYMATTR InstName R4
SYMATTR Value R={1.0/(0.0006+0.425*I(D2))}
SYMBOL res 192 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -9 87 VBottom 2
SYMATTR InstName R8
SYMATTR Value R={1.0/(0.0006+0.425*I(D1))}
SYMBOL Digital\\dflop 1120 -272 R0
SYMATTR InstName A2
SYMATTR SpiceLine Vhigh=5 Tfall=5n Trise=5n Td=12n ref=2.5
SYMATTR SpiceLine2 rhigh=1 rlow=1
SYMBOL OpAmps\\LT1638 1648 -224 R0
SYMATTR InstName U2
SYMBOL Digital\\or 880 -336 R0
SYMATTR InstName A1
SYMATTR SpiceLine2 rhigh=1 rlow=1
SYMATTR SpiceLine Vhigh=5 Tfall=5n Trise=5n Td=12n ref=2.5
SYMBOL Digital\\or 880 -176 R0
SYMATTR InstName A3
SYMATTR SpiceLine2 rhigh=1 rlow=1
SYMATTR SpiceLine Vhigh=5 Tfall=5n Trise=5n Td=12n ref=2.5
SYMBOL cap 544 -48 R0
SYMATTR InstName C4
SYMATTR Value 30p
SYMBOL Misc\\jumper 752 -400 R0
SYMATTR InstName X2
SYMBOL Misc\\jumper 752 -160 R0
SYMATTR InstName X3
SYMBOL Misc\\jumper -32 -272 R0
SYMATTR InstName X6
SYMBOL res 832 64 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res 832 -352 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res 64 -64 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL potentiometer 1552 0 M0
WINDOW 39 26 -3 Left 0
SYMATTR SpiceLine R=5k, Val=50
SYMATTR InstName X7
SYMBOL res 1392 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL cap 1376 -144 R0
WINDOW 3 -72 59 Left 2
SYMATTR Value 0.01µF
SYMATTR InstName C1
SYMBOL Misc\\jumper 384 -432 R0
SYMATTR InstName X4
SYMBOL Misc\\jumper 368 -128 R0
SYMATTR InstName X5
TEXT -272 56 Left 2 !.tran 50m startup
TEXT 200 -328 Left 3 ;CdS Cell
TEXT 200 -128 Left 3 ;CdS Cell
TEXT 1952 -240 Left 3 ;Red LED
TEXT 1944 -72 Left 3 ;Red LED
TEXT 1256 -616 Left 2 ;Cyanoacrylate Glue
TEXT 1272 224 Left 2 ;Cyanoacrylate Glue
TEXT -248 -1128 Left 2 ;Double-check variable resistor operation
TEXT 1264 -408 Left 2 ;Error Integrator
TEXT 2112 -176 Left 2 ;Yeah, yeah, probably only need one.\nBut I like the symmetry here :)
LINE Normal 2144 -240 2096 -240 2
LINE Normal 2144 -592 2144 -240 2
LINE Normal 288 -592 2144 -592 2
LINE Normal 288 -480 288 -592 2
LINE Normal 2128 -64 2080 -64 2
LINE Normal 2128 240 2128 -64 2
LINE Normal 288 240 2128 240 2
LINE Normal 288 16 288 240 2
